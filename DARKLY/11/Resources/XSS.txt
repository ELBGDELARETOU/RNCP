Ici, on se rend compte qu’en essayant de cliquer sur les images, seulement une nous permet
d’interagir avec elle. On regarde l’URL et on remarque qu’on peut faire une XSS (reflected cross‑site scripting)
via une injection d’URI (Uniform Resource Identifier).

Comment voit‑on cela ?
Car dans l’URL :

http://localhost:8080/index.php?page=media&src=nsa

on peut voir : src=nsa. Voici notre faille : elle nous permet d’injecter du contenu dans une balise.
Dans une injection URI, le but est de remplacer (dans notre cas « nsa ») par un schéma data: afin d’injecter du code JavaScript.

On peut voir dans l’URL ci‑dessous que « nsa » a été remplacé par :

data:text/html;base64,PHNjcmlwdD5hbGVydCg0Mik8L3NjcmlwdD4=

data: est le nom de la structure, ensuite on indique son type, comment c’est encodé,
et finalement le message qui nous permet de tester l’injection.

URL :

http://localhost:8080/index.php?page=media&src=data:text/html;base64,PHNjcmlwdD5hbGVydCg0Mik8L3NjcmlwdD4=

solution:
-filtrer strictement le parametre src pour autoriser que des valeurs predefinie
-ne jamais utiliser directement un parametre dans src d une images
-escape correctement permet de gerer certain caracteres speciaux qui sont utiliser pour les attaques comme : <, >, ", '.
